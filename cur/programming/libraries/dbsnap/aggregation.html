<!DOCTYPE html>
<html><head><!-- put the following in exactly --><script src="/bjc-r/llab/loader.js"></script><title>Aggregation</title><!-- Global site tag (gtag.js) - Google Analytics -->
<meta charset=“UTF-8”> <!-- for emojis -->
<!-- Lab Written by AI Michelle Cheung Fall 2020. Edited by AI Yishu Chao. -->
</head>

<body>
    <h3>Aggregation</h3>
    <p>Aggregation functions allow us to operate on data in a different way by combining results across multiple rows. Common aggregation functions to be familiar with include <b>COUNT, MAX, MIN, SUM, AVG.</b> </p>

    <h3>Group Operator</h3>
    <p>The <b>GROUP</b> operator groups rows that have the <b>same values</b> into summary rows. This brings back the point about how the NATURAL JOIN operator extends the number of columns we have available to us, which can help us identify the patterns in data. By using JOIN on both the Course_Students and Students, there are now multiple rows with the <b>same SID, LEVEL, AGE, FNAME, and LNAME values</b>, since the same student can be enrolled in multiple courses.</p>

    <p>We can use the GROUP operator on our previous NATURAL JOIN query to make a new query that groups by SID, FNAME, and LNAME, and counts the occurrences of a CID based on the student. This compresses all the rows that had the same SID, LEVEL, AGE, FNAME, and LNAME values into one row and creates a new column called count(CID) that shows the number of courses that the student is enrolled in. This might be a little hard to understand when reading it, so we have provided a visual explanation below.</p>

    <p>This is the node result of pressing on the Natural Join node. We&#39ve only selected Rodney for this example to better visualize what grouping does. You can do this by adding a SELECT block to your previous Natural Join query with the input FNAME = <q>Rodney.</q> As you can see, the Natural Join operator has created three rows that share the same SID, FNAME, LNAME, and AGE (off-screen) values. The only different value is the CID.</p>
    <p><img src="/bjc-r/img/dbsnap/aggregration_help_noderesult.png" alt="group query example" /></p>

    <p>After grouping by SID, FNAME, SID, and aggregating using count(CID), the query result counts the occurrences of CID for Rodney, which is 3. This query result is helpful because it counts how many classes Rodney is enrolled in for us. </p>
    <p><img src="/bjc-r/img/dbsnap/aggregration_help_queryresult.png" alt="group query example" /></p>


    <p>Now let&#39s try to apply this same query on the whole data set and not just Rodney. Your query should look like this:</p>
    <p><img src="/bjc-r/img/dbsnap/group_example.png" width="400" height="300" alt="group query example" /></p>
    <p>The query result should look like this:</p>
    <p><img src="/bjc-r/img/dbsnap/group_example_qresult.png" width="400" height="350" alt="group example query result" /></p>
    <p>As you can see, there are 90 entries instead of 100 entries &#40the number of entries in the students data set&#41. This means that there are 10 students that aren&#39t enrolled in any courses. &#x1F914; </p>


    <h3>Exercise #3: Aggregation and Join</h3>
    <p><b>3a.</b> Using the <q>Students</q> and <q>Course_Students</q> data sets, group students according to FNAME, LNAME, LEVEL, and AGE based on how many classes they have taken &#40should look pretty similar to the example above&#41. Also, make sure the query only includes students who are Sophomores and are 20 years old or older.</p>
    <p><b>Remember to save 3A before moving on.</b></p>
    <p><b>3b.</b> Using the <q>Students,</q> <q>Course_Students,</q> and <q>Courses</q> data sets, try finding the average age of students for each course. Make sure to group by both the CID and CNAME. <b>Remember to save when you are finished with 3B.</b></p>
    <p class="alert quoteBlue">
        Hint: You can use more than one NATURAL JOIN.
    </p>  
    <p>Congrats! You are done with the DBSnap lab. Hopefully you have learned a little more about the world of data science queries and are excited to potentially learn SQL in the future. </p>


</body>